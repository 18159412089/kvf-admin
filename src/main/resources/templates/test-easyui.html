<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title th:replace="comm/base::pagetitle"></title>
    <link th:replace="comm/base::static"/>
    <link rel="stylesheet" th:href="@{/static/plugins/easyui/themes/material/easyui.css}">
    <link rel="stylesheet" th:href="@{/static/plugins/easyui/themes/icon.css}">
</head>
<body style="background-color: #f2f2f2;">
<div class="layui-fluid kvf-fluid-padding15">
    <div class="layui-card">
        <div class="layui-form layui-card-header kvf-card-header-auto">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">文章ID</label>
                    <div class="layui-input-inline">
                        <input type="text" name="id" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">作者</label>
                    <div class="layui-input-inline">
                        <input type="text" name="author" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">标题</label>
                    <div class="layui-input-inline">
                        <input type="text" name="title" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">标签</label>
                    <div class="layui-input-inline">
                        <input type="text" name="label" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <button class="layui-btn layuiadmin-btn-list" lay-submit="" lay-filter="LAY-app-contlist-search">
                        <i class="layui-icon layui-icon-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="layui-card-body">
            <div id="headBtn" style="padding-bottom: 10px;">
                <button class="layui-btn" id="btn-expand">全部展开</button>
                <button class="layui-btn" id="btn-fold">全部折叠</button>
                <button class="layui-btn layuiadmin-btn-list" data-type="batchdel">删除</button>
                <button class="layui-btn layuiadmin-btn-list" data-type="add">添加</button>
            </div>
<!--            <table id="kContentTable" lay-filter="kContentTable" style=""></table>-->
            <table id="tt" class="easyui-treegrid" style="height: 476px; width: auto"></table>
        </div>
    </div>

</div>


<script type="text/html" id="rowToolbarTpl">
    <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
</script>

<script th:replace="comm/base::context"></script>
<script th:replace="comm/base::mainjs"></script>
<script th:src="@{/static/plugins/easyui/easyloader.js}"></script>

<script type="text/javascript" th:inline="none">
    /*layui.config({
        base: BASE_WEB + 'static/plugins/treetable-lay/'
    }).extend({
        treetable: 'treetable'
    }).use(['table', 'treetable'], function () {

        var $ = layui.jquery;
        var table = layui.table;
        var treetable = layui.treetable;



    });*/
    $(function () {

        // var data = {"total":9,"rows":[{"POPEDOM_NAME":"系统审计","TARGET":null,"IS_LOG":2,"PARENT_ID":"0","XH":541,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-05-30 22:00:15","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"42380957052241518e05d9e93a18ba5b","NAV_ICON":null,"REMARK":null,"TYPE":1},{"POPEDOM_NAME":"系统管理","TARGET":null,"IS_LOG":2,"PARENT_ID":"0","XH":596,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:07","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"4E85D7240102B0C0E0537F000001B0C0","NAV_ICON":null,"REMARK":null,"TYPE":1},{"POPEDOM_NAME":"JavaMelody监控","TARGET":null,"IS_LOG":2,"PARENT_ID":"0","XH":569,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:07","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/javaMelody","ID":"81d26170ccca4cbe9ee9bec3dc0cc01d","NAV_ICON":null,"REMARK":null,"TYPE":3},{"POPEDOM_NAME":"Druid监控","TARGET":null,"IS_LOG":2,"PARENT_ID":"0","XH":576,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:05","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/druid","ID":"3be53b6437ba4162a1bfe166f795cd99","NAV_ICON":null,"REMARK":null,"TYPE":3},{"POPEDOM_NAME":"后台权限配置","TARGET":null,"IS_LOG":2,"PARENT_ID":"0","XH":568,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-04-26 23:11:54","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"4F3A7FB1C2E3A080E0537F000001A080","NAV_ICON":null,"REMARK":null,"TYPE":4},{"POPEDOM_NAME":"操作日志","TARGET":null,"IS_LOG":2,"PARENT_ID":"42380957052241518e05d9e93a18ba5b","XH":577,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2018-04-24 21:35:26","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/log","ID":"0e15bc482d5e4b1b92b8aeee03c3eab2","NAV_ICON":null,"REMARK":null,"TYPE":1},{"POPEDOM_NAME":"退出","TARGET":null,"IS_LOG":1,"PARENT_ID":"4F3A7FB1C2E3A080E0537F000001A080","XH":24,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-05-24 15:07:18","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/login/logOut","ID":"a6060cb354a74a3aad0464ea71b48377","NAV_ICON":null,"REMARK":null,"TYPE":2},{"POPEDOM_NAME":"权限列表","TARGET":null,"IS_LOG":2,"PARENT_ID":"4F3A7FB1C2E3A080E0537F000001A080","XH":25,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-05-24 15:07:18","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/popedomList","ID":"4F3A7FB1C2E5A080E0537F000001A080","NAV_ICON":null,"REMARK":null,"TYPE":2},{"POPEDOM_NAME":"主页","TARGET":null,"IS_LOG":2,"PARENT_ID":"4F3A7FB1C2E3A080E0537F000001A080","XH":351,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-04-30 20:48:56","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin","ID":"4F3A7FB1C2E4A080E0537F000001A080","NAV_ICON":null,"REMARK":null,"TYPE":2}]};
        var data = {"total":9,"rows":[{"POPEDOM_NAME":"系统审计","TARGET":null,"IS_LOG":2,"XH":541,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-05-30 22:00:15","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"42380957052241518e05d9e93a18ba5b","NAV_ICON":null,"REMARK":null,"TYPE":1},{"POPEDOM_NAME":"系统管理","TARGET":null,"IS_LOG":2,"_parentId":null,"XH":596,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:07","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"4E85D7240102B0C0E0537F000001B0C0","NAV_ICON":null,"REMARK":null,"TYPE":1},{"POPEDOM_NAME":"JavaMelody监控","TARGET":null,"IS_LOG":2,"_parentId":null,"XH":569,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:07","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/javaMelody","ID":"81d26170ccca4cbe9ee9bec3dc0cc01d","NAV_ICON":null,"REMARK":null,"TYPE":3},{"POPEDOM_NAME":"Druid监控","TARGET":null,"IS_LOG":2,"_parentId":null,"XH":576,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-06-01 15:23:05","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/druid","ID":"3be53b6437ba4162a1bfe166f795cd99","NAV_ICON":null,"REMARK":null,"TYPE":3},{"POPEDOM_NAME":"后台权限配置","TARGET":null,"IS_LOG":2,"_parentId":null,"XH":568,"CREATER_ID":null,"NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2019-04-26 23:11:54","NAV_ICON_WIDTH":null,"FORWARD_ACTION":null,"ID":"4F3A7FB1C2E3A080E0537F000001A080","NAV_ICON":null,"REMARK":null,"TYPE":4},{"POPEDOM_NAME":"操作日志","TARGET":null,"IS_LOG":2,"_parentId":"42380957052241518e05d9e93a18ba5b","XH":577,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2018-04-24 21:35:26","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/log","ID":"0e15bc482d5e4b1b92b8aeee03c3eab2","NAV_ICON":null,"REMARK":null,"TYPE":1}],"footer":[
                {"POPEDOM_NAME":"Total Persons:","persons":9,"iconCls":"icon-sum"}
            ]};
        easyloader.load('treegrid', function () {
            // $("#tt").treegrid('loadData', data);
            $('#tt').treegrid({
                url:'/tree/list',
                method: 'get',
                // data: data,
                idField:'ID',
                treeField:'POPEDOM_NAME',
                toolbar: '#headBtn',
                // rownumbers: true,
                pagination: true,
                pageNumber: 1,
                pageSize: 10,
                pageList: [10, 20, 30, 40, 50],
                sortName: 'menuName',
                showHeader: true,
                // fitColumns: true,
                // striped: true,
                // nowrap: true,
                animate: true,
                // lines: true,
                scrollbarSize: 18,
                scrollOnSelect: false,
                fitColumns: false,
                checkbox: true,
                frozenColumns: [[
                    {field: 'POPEDOM_NAME', title: '名称', editor:'text', sortable: true, width:220}
                    ,{field: 'FORWARD_ACTION', title: 'URL', editor:'text', sortable: true, width:200}
                ]],
                columns:[[
                    {field: 'REMARK', title: '备注', editor: 'text', sortable: true, width:150}
                    ,{field: 'TYPE', title: '类型', sortable: true, width:160}
                    ,{field: 'IS_LOG', title: '是否审计', sortable: true, width:160}
                    ,{field: 'ENTRY_TIME', title: '录入时间', sortable: true, width:180}
                    // ,{title: '操作',field: 'ID', formatter: formatter.formatTools, width:110}
                    // ,{title: '排序',field: 'XH', formatter: formatter.formatMoveTools, width:100}
                ]],
                loadFilter: function (data) {
                    var rows = data.data;
                    // kvfKit.toJSON()
                    var r = data.data;
                    r = JSON.parse(r);
                    rows = r.rows;
                    if (rows == undefined) rows = r;
                    for(var i=0; i<rows.length; i++) {
                        /*if (rows[i].PARENT_ID == '0') {
                            rows[i]._parentId = null;
                        } else {
                            rows[i]._parentId = rows[i].PARENT_ID;
                        }*/

                        if (rows[i].TYPE == 2) {
                            rows[i].state = "open";
                        } else {
                            rows[i].state = "closed";
                        }
                    }
                    log(r);
                    return r;
                },
                onLoadSuccess : function (row, data) {
                    $(this).datagrid('freezeRow', 0).datagrid('freezeRow', 1); //冻结前两列
                },
                onBeforeExpand: function (row) {
                    // $(this).treegrid('load', {id: '1'});
                    /*log('row=', row);
                    $(this).treegrid('append', {
                        after: row.id,  // the node has a 'id' value that defined through 'idField' property
                        data: [{"POPEDOM_NAME":"操作日志","TARGET":null,"IS_LOG":2,"_parentId":"42380957052241518e05d9e93a18ba5b","XH":577,"CREATER_ID":"9DE5260188E2451F82FEED173E464A1B","NAV_ICON_HEIGHT":null,"ENTRY_TIME":"2018-04-24 21:35:26","NAV_ICON_WIDTH":null,"FORWARD_ACTION":"/admin/log","ID":"0e15bc482d5e4b1b92b8aeee03c3eab2","NAV_ICON":null,"REMARK":null,"TYPE":1}]
                    })
                    $(this).treegrid('reload');*/
                },
                /*onCheck : function(row){
                    t = $(this);
                    opts = t.treegrid("options");
                    if (opts.checkOnSelect && opts.singleSelect) { return; }
                    var idField = opts.idField, id = row[idField], children, checked, parent = row;
                    //如果当前节点被勾选,那么勾选该节点的子节点
                    $.each(t.treegrid("getChildren", id), function (i, n) {
                        if (!t.treegrid("isChecked", n[idField])) { t.treegrid("check", n[idField]); }
                    });
                },*/
            });

        });


    });
</script>

</body>
</html>